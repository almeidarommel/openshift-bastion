#!/bin/bash

echo "Download openshift-install command"
if [ ! -f ${HOME}/${OCP_INSTALLER_FILE} ]
then
    wget ${URL_OCP_INSTALLER} 
    tar -xvzf ${HOME}/${OCP_INSTALLER_FILE}
    chmod +x ${HOME}/openshift-install
fi

echo "Creating install-config.yaml"
if [ ! -f ${INSTALLERS_DIR_PATH}/install-config.yaml ]
then
    ansible-playbook ${INSTALLERS_DIR_PATH}/playbook.yaml
fi

echo "Preparing the install environment"
${HOME}/openshift-install create manifests --dir=${INSTALLERS_DIR_PATH}
${HOME}/openshift-install create ignition-configs --dir=${INSTALLERS_DIR_PATH}