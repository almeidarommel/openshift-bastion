---
- hosts:
    - masters
    - infras
    - appnodes
    
  vars:
      rh_user: 'jonas.cavalcanti@goldentechnologia.com.br'

  vars_prompt:
    - name: rh_password
      prompt: "Your Subscription Password:"
      private: yes
      
  tasks:
    - name: redhat_subscription Nodes
      redhat_subscription:
        state: present
        username: "{{ rh_user }}"
        password: "{{ rh_password }}"

    - name: Disable all Repositories
      command: subscription-manager repos --disable="*"

    - name: Refresh Subscription
      command: "subscription-manager refresh"

